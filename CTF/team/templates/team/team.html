{% extends "base.html" %}
{% load static %}

{% block title %}
    <title>میدریت تیم</title>
{% endblock title %}

{% block content %}
    <div style="display: flex;flex-direction: column;">
        <div class="team-card">
            <h2>عضویت در تیم</h2>
            <div class="team-action">
                <form action="{% url "InviteUser" %}" method="post" class="join-team-code">
                    {% csrf_token %}
                    <label for="invite-code">کد دعوت تیم</label>
                    <input type="text" id="invite-code" name="invite_code" placeholder="کد دعوت تیم را وارد کنید" required>
                    <input type="submit" value="پیوستن">
                </form>
                <div class="team-back-link" style="width: fit-content;position: absolute;bottom: 10px;">
                    <a href="{% url "home" %}">بازگشت</a>
                </div>
                <form action="{% url "CreateTeam" %}" method="post" class="create-team">
                    {% csrf_token %}
                    <label for="team-name">نام تیم</label>
                    <input id="team-name" type="text" name="team_name" placeholder="نام تیم" required>
                    <label for="team-bio">توضیحات تیم</label>
                    <textarea name="team_desciption" id="team-bio" placeholder="توضیحات تیم" cols="50" rows="5" required></textarea>
                    <input type="submit" value="تشکیل تیم">
                    {% if messages %}
                        {% for message in messages %}
                            <h3 class="{{message.tags}}">{{message}}</h3>
                        {% endfor %}
                    {% endif %}
                </form>
            </div>
        </div>
        {% if team and members%}
            <div class="team-settings">
                <div class="team-informatio">
                    <a>{{team.name}}</a>
                    <button id="copy-invite-code" data-invite="{{ team.id }}">کد دعوت تیم</button>
                    {% if team.manager == request.user %}
                    <a id="team-settings" href="{% url "TeamSettings" %}">تنظیمات تیم</a>
                    {% endif %}
                </div>
                <hr>
                <div class="table-container">
                    <table class="team-table">
                        <thead>
                            <tr>
                            <th>کابران</th>
                            <th>اولین خون</th>
                            <th>چالش های طراحی شده</th>
                            <th>چالش های حل شده</th>
                            <th>امتیاز</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for infos in members %}
                                <tr>
                                    <td>{{infos.username}}</td>
                                    <td>{{infos.first_bloods}}</td>
                                    <td>{{infos.created_challs}}</td>
                                    <td>{{infos.solved_challs}}</td>
                                    <td>{{infos.score}}</td>
                                </tr>
                            {% endfor %}
                    </table>
                </div>
            </div>
        {% endif %}
    </div>
{% endblock content %}

{% block script %}
    <script src="{% static "js/team.js" %}"></script>
{% endblock script %}

